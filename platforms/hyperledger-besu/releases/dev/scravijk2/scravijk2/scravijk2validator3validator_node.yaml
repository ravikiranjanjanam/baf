apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: scravijk2validator3validator-node
  namespace: scravijk2-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: scravijk2validator3validator-node
  interval: 1m
  chart:
   spec:
    chart: platforms/hyperledger-besu/charts/node_validator
    sourceRef:
      kind: GitRepository
      name: flux-besu-ravijk2
      namespace: flux-besu-ravijk2
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://35d707180a4b55018f7b2fa3737f9638e7cfeae21e38db1e7b90f9f3455a859ccd405969104ff2eaad9cb6733d1d192510ff05ad3c2595d1e85f5a9c26666463@validator1.beveldev.dev.aws.blockchaincloudpoc-develop.com:15081"
      - "enode://52a35dcff2b327bf151276e6ba63fe779f268de3e4bd0774a813a07547455bab1b0517001ffcfec55346145b2edf78f5b33d6dfbb60ddeadbf83f450fec5296e@validator2.beveldev.dev.aws.blockchaincloudpoc-develop.com:15083"
      - "enode://b78414cab70dec3e84c476f663addaef2f05468da071452bc7ede54038c9dc1dd9ae401a441284b4638ba4379249750e176491d87b2bea7c06f1aa0749dec7a2@validator3.beveldev.dev.aws.blockchaincloudpoc-develop.com:15085"
      - "enode://efee39c8fcd95bc5dce67393728f601cf0e348023a1d642c92539dda0602dfe584b058416eddcf2661f57b994ad720136c43928f061ed3b721c76533987f84cb@validator4.beveldev.dev.aws.blockchaincloudpoc-develop.com:15087"
      - "enode://123815cfa41b4d4517f9754557e7abff3d035f93c582e8b53e0d8c7c65a846f9ac1fbe94a26bc68d1c02f017380a7f5f5de5d55e7df419d9f2e95fd7cd8dcd88@cravijk2.beveldev.dev.aws.blockchaincloudpoc-develop.com:15089"

    metadata:
      namespace: scravijk2-bes
      labels:

    ambassador:
      external_url_suffix: beveldev.dev.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
    proxy:
      provider: ambassador
      external_url: scravijk2.beveldev.dev.aws.blockchaincloudpoc-develop.com
      p2p: 15085
      rpc: 15086

    images:
      node: hyperledger/besu:22.10.2
      alpineutils: ghcr.io/hyperledger/bevel-alpine:latest
      pullPolicy: IfNotPresent

    node:
      name: validator3
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

      permissioning:
        enabled: False
      
    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev.aws.blockchaincloudpoc-develop.com:20002
      secretprefix: secretsv2/data/scravijk2-bes/crypto/validator3
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besuscravijk2
      type: hashicorp

    genesis: ewogICAiY29uZmlnIjogewogICAgICJjaGFpbklkIjogIDIwMTgsCiAgICAgImNvbnN0YW50aW5vcGxlZml4YmxvY2siOiAwLAogICAgICJjb250cmFjdFNpemVMaW1pdCI6IDIxNDc0ODM2NDcsCiAgICAgImliZnQyIjogewogICAgICAgImJsb2NrcGVyaW9kc2Vjb25kcyI6IDIsCiAgICAgICAiZXBvY2hsZW5ndGgiOiAzMDAwMCwKICAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgIH0KICAgfSwKICAgIm5vbmNlIjogIjB4MCIsCiAgICJ0aW1lc3RhbXAiOiAiMHg1OGVlNDBiYSIsCiAgICJnYXNMaW1pdCI6ICIweDFmZmZmZmZmZmZmZmZmIiwKICAgImRpZmZpY3VsdHkiOiAiMHgxIgp9


    metrics:
      enabled: False
      port: 9545    
