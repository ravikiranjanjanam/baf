apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: scravijk2validator4validator-node
  namespace: scravijk2-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: scravijk2validator4validator-node
  interval: 1m
  chart:
   spec:
    chart: platforms/hyperledger-besu/charts/node_validator
    sourceRef:
      kind: GitRepository
      name: flux-besu-ravijk2
      namespace: flux-besu-ravijk2
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://9feb874a3655d22d2456e3f5a62398b7e7f17d9b8574e09858f914518967f9b3cc660d629d71c22cc2803e75784f270e727c9d759ee14d7c7d1c5e1ff0e9fed7@validator1.beveldev.dev.aws.blockchaincloudpoc-develop.com:15081"
      - "enode://c10eafa3bc5b6ab8b2b2dbebe9e90b5746972588709fb6515191b2df47e1808137c74d5070da48dfd7036ec17b170bcf03e8441dce571924afac39bf52b04c68@validator2.beveldev.dev.aws.blockchaincloudpoc-develop.com:15083"
      - "enode://773e1df8b4d28e566b7a84690e13dab358df564e38e973f5722b324aae2576510763a5125a5329cd8f2f626e4623be243d022dc227f1f6f50efb087e3230479e@validator3.beveldev.dev.aws.blockchaincloudpoc-develop.com:15085"
      - "enode://aab02131dc66f6ec60d8d93e70df2529ecaecf8c8bfe3a306819342e1283cae7d1c78ab247bf9a8ce4f003f5c1013c5280efa07711e10439dcb6c2138d1c2705@validator4.beveldev.dev.aws.blockchaincloudpoc-develop.com:15087"
      - "enode://897d1a7170bad36919d703f69a2f6761557497039a88de540898c6f773f3ca06b123cf4d631f3c4f86fd928d178b92792842af52cfad38d6ac51986d63944930@cravijk2.beveldev.dev.aws.blockchaincloudpoc-develop.com:15089"

    metadata:
      namespace: scravijk2-bes
      labels:

    ambassador:
      external_url_suffix: beveldev.dev.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
    proxy:
      provider: ambassador
      external_url: scravijk2.beveldev.dev.aws.blockchaincloudpoc-develop.com
      p2p: 15087
      rpc: 15088

    images:
      node: hyperledger/besu:22.10.2
      alpineutils: ghcr.io/hyperledger/bevel-alpine:latest
      pullPolicy: IfNotPresent

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

      permissioning:
        enabled: False
      
    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev.aws.blockchaincloudpoc-develop.com:20002
      secretengine: secretsv2
      secretprefix: data/scravijk2-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besuscravijk2
      type: hashicorp

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGRhMDk2M2JhZDE5NTQ5MDE3YTQxZWFkMGQ1NTcwYTY4YWI3MGVjNWQ5NDcxNzI1MjIyNjgzZmE0ZDQ0NTcxYjI3MjZhMjExOGI4NTBlZTJkOTI5NDZmZTU2NzE5YWY4ODNhYzc5MzY5YjEyZjE0NjMwNDYwMjliNGQ0MTk5NDc5ZGM0NTcwOTVjNzI2Zjk2MzA1MTUyYjc3M2E3ZWYyNmFhNzAwMDY4MDg0MDAwMDAwMDBjMCIKfQ==


    metrics:
      enabled: False
      port: 9545    
