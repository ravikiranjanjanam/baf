apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: scravijk2validator2validator-node
  namespace: scravijk2-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: scravijk2validator2validator-node
  interval: 1m
  chart:
   spec:
    chart: platforms/hyperledger-besu/charts/node_validator
    sourceRef:
      kind: GitRepository
      name: flux-besu-ravijk2
      namespace: flux-besu-ravijk2
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://593d3868f64ccac8d190a6be4f89e83af3dc52999b2ac78578eb4526ae4c5560416d6da3f34d3cec11a341e4d0ff6264aeabc6a9bda6b630297e9f2ead855fcf@validator1.beveldev.dev.aws.blockchaincloudpoc-develop.com:15081"
      - "enode://4fd6e5c45cf0050958b20d97484f1a2d02a717bec6f9a3fde041d31909cb0979e5e13a58d13d0f1b2a5a46a39fda8af77d865397922c722584bd5f3a98959d18@validator2.beveldev.dev.aws.blockchaincloudpoc-develop.com:15083"
      - "enode://3805bb4e5ca0a52192bc50071f0727127376d5cd675aa91ab960ebae78b1ee42ddfda4de15865df520084b574cd9c0028955c043e31943f70de75c7541184700@validator3.beveldev.dev.aws.blockchaincloudpoc-develop.com:15085"
      - "enode://1a0a40179b6d71f1fb3a5c969a0ff869ae418c82fe0574dc06980dc70b0a93c5ceea149e98da09acf95739dd887113f96f9ec52f0fa15c0cc969d518c20bf5b7@validator4.beveldev.dev.aws.blockchaincloudpoc-develop.com:15087"
      - "enode://6046d81c1d7e2ff8909c75fdeafea3b40f89771c7015c0b69f3f22f93f53a80b32c5652eb597d00075c79901016c5069ee061bc7307c21249942631283c51647@cravijk2.beveldev.dev.aws.blockchaincloudpoc-develop.com:15089"

    metadata:
      namespace: scravijk2-bes
      labels:

    ambassador:
      external_url_suffix: beveldev.dev.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
    proxy:
      provider: ambassador
      external_url: scravijk2.beveldev.dev.aws.blockchaincloudpoc-develop.com
      p2p: 15083
      rpc: 15084

    images:
      node: hyperledger/besu:22.10.2
      alpineutils: ghcr.io/hyperledger/bevel-alpine:latest
      pullPolicy: IfNotPresent

    node:
      name: validator2
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

      permissioning:
        enabled: False
      
    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.dev.aws.blockchaincloudpoc-develop.com:20002
      secretengine: secretsv2
      secretprefix: data/scravijk2-bes/crypto/validator2
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besuscravijk2
      type: hashicorp

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDI0N2IxMzgwM2EwOWZkMGZhMWQwYzYwODY2NmNjYmE0MzI4MGQ1ODM5NGFhMDE3NzMyNmEwYmQ5NDA1NTM3ZjgzODA1MjY2ZDg4ZmMxOTUxNjg5NGIwNTgxYzQyYjRmNDlmOTk0YTllODk4ZGY3YTc5ZDY3NGM0MjI0OGE5NDg3ZDdmNDE3OGVlMDJiMGNiYzMxMTg5MzJjMWJiOTlhNmJkNmRiOWQ4MDg0MDAwMDAwMDBjMCIKfQ==


    metrics:
      enabled: False
      port: 9545    
