apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: scsc0validator4validator-node
  namespace: scsc0-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: scsc0validator4validator-node
  interval: 1m
  chart:
   spec:
    chart: platforms/hyperledger-besu/charts/node_validator
    sourceRef:
      kind: GitRepository
      name: flux-besu-sc0
      namespace: flux-besu-sc0
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://8aa1a8f5712d91daa1ff58210567f66c4fe67da8a8157fecc696b1329fd30bec18bcf17526654e2f0a19241612c868121c3f6afa565f23f6cd46bf87f5902a6c@validator1.workshop.bes.demo.aws.blockchaincloudpoc-develop.com:15011"
      - "enode://6e8ebe295057cdf71bb4039d201f68fe00c878d869e4117da782c908729549ba184778634539134759ae61df2833231395fbf0330399180dd3c3722d6e0349d8@validator2.workshop.bes.demo.aws.blockchaincloudpoc-develop.com:15013"
      - "enode://582e5650a0adbb2c9392793118c99ba43c62b24972dae46b1483573db993305e624f5ad552fa16bb6fb7b18d0ca79672ef94fc82d273e8d230ee820c2edc055c@validator3.workshop.bes.demo.aws.blockchaincloudpoc-develop.com:15015"
      - "enode://32ee01f80d81eef9c4318e776b6e5e1118498140acd4ee6ae0dbb1d435a00f9cc7438f9ba0cdc2b529578340e82ac3ed58ba684dab332fb0e280e62996e2c951@validator4.workshop.bes.demo.aws.blockchaincloudpoc-develop.com:15017"
      - "enode://472900bc0fece584c2ea10ebd7df5c2968d0f238a692db457ba582d076784ed23589c51e5bde9871f3473ae37289a810857b6445b934b77c37a1774cb709a7a4@csc0.workshop.bes.demo.aws.blockchaincloudpoc-develop.com:15019"

    metadata:
      namespace: scsc0-bes
      labels:

    ambassador:
      external_url_suffix: workshop.bes.demo.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
    proxy:
      provider: ambassador
      external_url: scsc0.workshop.bes.demo.aws.blockchaincloudpoc-develop.com
      p2p: 15017
      rpc: 15018

    images:
      node: hyperledger/besu:22.10.2
      alpineutils: ghcr.io/hyperledger/bevel-alpine:latest
      pullPolicy: IfNotPresent

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

      permissioning:
        enabled: False
      
    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://ad5479b2bb371412d86570caf3140882-424952426.eu-west-1.elb.amazonaws.com:20001
      secretprefix: secretsv2/data/scsc0-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besuscsc0

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGE0YjIwNTUxMzQ4NzQ2MzFkOGM4YzdlZTlkZTFjYmUzZGY5MGJlOTE5NGRjNjFlYTk0MmMwNWRkOWVmOGY1ZGM4OWM5MGEwZmRmODZkYjZhNGI5NDQ5ZjZkYWZiOTUxYzAyZDJiNzdkOTMzZTBhZGMxMDEyYzkzNWEwYTI5NDQ1Y2E4Y2JjZWYxNzcxMzE5M2Y3ZTZhMjczMzcyMGZhOTk1Yjg5ZTc4MDg0MDAwMDAwMDBjMCIKfQ==


    metrics:
      enabled: False
      port: 9545    
