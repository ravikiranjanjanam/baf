apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: scsc0validator2validator-node
  namespace: scsc0-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: scsc0validator2validator-node
  interval: 1m
  chart:
   spec:
    chart: platforms/hyperledger-besu/charts/node_validator
    sourceRef:
      kind: GitRepository
      name: flux-besu-sc0
      namespace: flux-besu-sc0
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://9c6267e756faa5421fe8210a0128454567cceebacbae6ac1dab2bdfd587acfafcefe5bf526e713d01e334a16d8432f13bb9035f7d7785aae9d70fd35900ff1d8@validator1.bes.demo.aws.blockchaincloudpoc-develop.com:15011"
      - "enode://df1025619da80ed62f023504dfb5ef3008954362263186830da025b93292b5927b57e2de91a0bd7525443b8ad6c88f81e322ad5d09eb0632f919f54cb0a85dee@validator2.bes.demo.aws.blockchaincloudpoc-develop.com:15013"
      - "enode://300c142bfad48edd6fe600c9c15249c5968e4611b8f306b2c8172a8d59e974dfdac9d94cb00d02e2c2a6edd9a823fa59103923364b9b56ab65919be064b12171@validator3.bes.demo.aws.blockchaincloudpoc-develop.com:15015"
      - "enode://08588946c13175d974fd1a844c27ecbe7f514920e8422ab072598ced6d710aeddebde604d9211f6aaec3c6680e7110d8cbe19fb34cf4348078b7bc03d2124559@validator4.bes.demo.aws.blockchaincloudpoc-develop.com:15017"
      - "enode://2ebeed17486cc68c05980221c7cb191c9b11c92de7505426a3379517755509e332cb4efc136baf7f27e33a5b5da2ef0c716d0aff62f8ae4b5dc24ff627b972f6@csc0.bes.demo.aws.blockchaincloudpoc-develop.com:15019"

    metadata:
      namespace: scsc0-bes
      labels:

    ambassador:
      external_url_suffix: bes.demo.aws.blockchaincloudpoc-develop.com

    liveliness_check:
      enabled: false
    proxy:
      provider: ambassador
      external_url: scsc0.bes.demo.aws.blockchaincloudpoc-develop.com
      p2p: 15013
      rpc: 15014

    images:
      node: hyperledger/besu:22.10.2
      alpineutils: ghcr.io/hyperledger/bevel-alpine:latest
      pullPolicy: IfNotPresent

    node:
      name: validator2
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

      permissioning:
        enabled: False
      
    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://ad5479b2bb371412d86570caf3140882-424952426.eu-west-1.elb.amazonaws.com:20001
      secretprefix: secretsv2/data/scsc0-bes/crypto/validator2
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besuscsc0

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NGJjOTI3YjBmNWE0YjA4Mjg5MDkwMjkwZmI1ZDU2MzY4ZmU1M2E0YjM5NDA3OTIzNmI4NjJlNjc4ZTVjNDEyYzFiNjZlYmM4Nzc1ZGRmZDAyMWM5NDMwNWJhYWNiYjMwOTZmY2FjOWJmNGFlZDMwMTU1ZmQwMDJiMzEzNjc5NDU3NDhkYTVhYTQwZDc3ODk2OGIxMDlkY2ZjNzczMDZjYjIzZjdhNTc4MDg0MDAwMDAwMDBjMCIKfQ==


    metrics:
      enabled: False
      port: 9545    
